---
title: "p8105_hw2_cm3341"
author: "Carolina Montes Garcia"
date: "2024-10-01"
output: 
  github_document:
    toc: true
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

library(tidyverse)
library(readxl)
```

## Problem 1

Import and clean dataset 
```{r}
nyc_transit_data = 
  read_csv("data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv", na = c("NA", "."))

nyc_transit_data = 
    janitor::clean_names(nyc_transit_data)

colnames(nyc_transit_data)

nyc_transit_data = 
  select(nyc_transit_data, line, station_name, station_latitude, station_longitude, route1, route2, route3, route4, route5, route6, route7, route8, route9, route10, route11, entry, vending, entrance_type, ada)

nyc_transit_data = nyc_transit_data %>%
  mutate(entry_logical = case_when(
    entry == "YES" ~ TRUE,
    entry == "NO" ~ FALSE,
    TRUE ~ NA
  ))
```

Dataset description: use inline code 

```{r}
nyc_transit_data %>%
  distinct(station_name, line) %>% 
  nrow()
```
There are 465 distinct stations. 

```{r}
nyc_transit_data %>%
  filter(ada == "TRUE")
```


## Problem 2

Import and clean Mr. trash wheel dataset. The *year* variable has to be mutated into the same type of variable so that the binding function can work the dataset merging step later on. I chose to make all years into numeric variables using `as.numeric`.
```{r}

mr_trash_wheel_data <- read_excel("data/202409 Trash Wheel Collection Data.xlsx", sheet = "Mr. Trash Wheel", skip = 1, na = c("NA", ".")) %>%
  janitor::clean_names() %>%
  slice(1:(n() - 2)) %>%
  mutate(sports_balls = as.integer(round(sports_balls, 0)),  
         trash_wheel = "Mr. Trash Wheel")%>%
  select(-x15, -x16)%>%
  mutate(year = as.numeric(year))
```


Import and clean professor trash wheel data. 

```{r}

prof_wheel_data <- read_excel("data/202409 Trash Wheel Collection Data.xlsx", sheet = "Professor Trash Wheel", skip = 1, na = c("NA", ".")) %>%
  janitor::clean_names() %>%
  slice(1:(n() - 2)) %>%
  mutate(trash_wheel = "Professor Trash Wheel")%>%
  mutate(year = as.numeric(year))
  
```

Import and clean gwynnda trash wheel data.
```{r}
gwynnda_wheel_data <- read_excel("data/202409 Trash Wheel Collection Data.xlsx", sheet = "Gwynnda Trash Wheel", skip = 1, na = c("NA", ".")) %>%
  janitor::clean_names() %>%
  slice(1:(n() - 1)) %>%
  mutate(trash_wheel = "Gwynnda Trash Wheel")%>%
  mutate(year = as.numeric(year))
```

Combine the three datasets. 

```{r}

full_trash_wheel_data = bind_rows(mr_trash_wheel_data, prof_wheel_data, gwynnda_wheel_data)
```

Calculate # of total observations in the combined dataset
```{r}
total_rows <- nrow(full_trash_wheel_data)

```

Calculate how many tons of trash were collected by professor trash wheel.
```{r}

prof_trash_weight = full_trash_wheel_data %>%
  filter(trash_wheel == "Professor Trash Wheel") %>%
  summarise(total_weight = sum(weight_tons, na.rm = TRUE))
```


```{r}
gwynnda_cigs_062022 = full_trash_wheel_data %>%
  filter(trash_wheel == "Gwynnda", format(as.Date(date), "%Y-%m") == "2022-06") %>%
  summarise(total_cig_butts = sum(cigarette_butts, na.rm = TRUE))

```

The combined dataset from the three Trash Wheels contains `r total_rows` observations. 

Professor Trash Wheel collected a total of `r prof_trash_weight` tons of trash. 

- Issue with Gwynnda cigs, check code-

## Problem 3

Import the `bakers` dataset. Used the separate command to split the full names in the *baker_name* column so I can use the first name as an ID variable across all of the datasets. There are people who have the same first name across series, but I will get around that by filtering by series first, and then by first name. 
```{r}

bakers_data = 
  read_csv("data/bakers.csv", na = c("NA", ".")) %>%  
  janitor::clean_names()

bakers_data = bakers_data %>%
  separate(baker_name, into = c("first_name", "last_name"), sep = " ")

```

Imported the `bakes` dataset. I renamed the *baker* variable to *first_name* to standardize this variable across datasets. 

```{r}
bakes_data = 
  read_csv("data/bakes.csv", na = c("NA", "."))%>%  
  janitor::clean_names()

bakes_data = 
  bakes_data %>%
  rename(first_name = baker)

```


Imported the `results` dataset. I renamed the *baker* variable to *first_name* to standardize this variable across datasets. 
```{r}
results_data = 
  read_csv("data/results.csv", skip = 2, na = c("NA", "."))%>%  
  janitor::clean_names()

results_data = 
  results_data %>%
  rename(first_name = baker)
```

```{r, eval = FALSE}
combined_bakes_bakers <- bakes_data %>%
  left_join(bakers_data, by = c("series", "first_name"))
```

Check 